option_settings:
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    PORT: 5000
    MONGODB_URI: ${MONGODB_URI}
    JWT_SECRET: ${JWT_SECRET}
    STRIPE_SECRET_KEY: ${STRIPE_SECRET_KEY}
    STRIPE_PUBLISHABLE_KEY: ${STRIPE_PUBLISHABLE_KEY}
    SMTP_HOST: ${SMTP_HOST}
    SMTP_PORT: ${SMTP_PORT}
    SMTP_USER: ${SMTP_USER}
    SMTP_PASS: ${SMTP_PASS}
    SENTRY_DSN: ${SENTRY_DSN}

  aws:elasticbeanstalk:container:nodejs:
    NodeCommand: "npm start"
    NodeVersion: 18.x

  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: nginx

  aws:autoscaling:launchconfiguration:
    InstanceType: t3.micro
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role

  aws:autoscaling:asg:
    MinSize: 1
    MaxSize: 4

  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced

  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 7

  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /api/health
    Port: 5000
    Protocol: HTTP

  aws:elasticbeanstalk:environment:proxy:staticfiles:
    /static: /static
    /uploads: /uploads 